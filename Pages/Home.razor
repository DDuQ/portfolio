@page "/"
@using System.Diagnostics.CodeAnalysis

<PageTitle>Esteban Duque</PageTitle>

<!-- HERO -->
<section class="text-slate-100">
    <div class="container-hero">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
            <!-- Left: intro -->
            <div>
                <h1 class="text-2xl md:text-5xl font-bold leading-tight">
                    Hi there, <br> I'm Esteban. ðŸ‘‹
                </h1>
                
                <div class="flex items-center space-x-6 mt-4">
                    <a href="/resume" class="inline-flex items-center h-9 px-3 border border-transparent text-sm font-medium rounded-md text-white bg-slate-700 hover:bg-slate-800">
                        <span class="flex items-center">
                            Resume
                            <span class="icon icon-download icon--md ml-1" aria-hidden="true"></span>
                        </span>
                    </a>
                    <a href="https://github.com/DDuQ" class="hover:text-slate-800">
                        <span class="sr-only">GitHub</span>
                        <span class="icon icon-github icon--lg" aria-hidden="true"></span>
                    </a>
                    <a href="https://www.linkedin.com/in/dduq/" class="hover:text-slate-800">
                        <span class="sr-only">LinkedIn</span>
                        <span class="icon icon-linkedin icon--lg" aria-hidden="true"></span>
                    </a>
                </div>
                
                <p class="mt-4 text-lg text-slate-300">
                    @(GetCurrentAge())yo Software Engineer specialized in backend development with .NET and C#.
                </p>

            </div>

            <!-- Right: photo stack -->
            <div class="relative justify-self-center">
                <img class="relative h-72 object-fill object-cover object-center"
                     src="profile-pic.png" alt="profile picture" />
            </div>
        </div>
    </div>
    </section>

<!-- TIMELINE SECTION -->
<section class="container-section">
        <!-- Tabs -->
        <div class="mb-4 flex rounded-xl border border-slate-700/40 bg-slate-900/60 p-1">
            <button class="w-1/2 rounded-lg px-4 py-2 text-sm font-semibold transition @(activeTab == "Work" ? "bg-slate-800 text-white" : "text-slate-300 hover:text-white")"
                    @onclick='() => activeTab = "Work"'>Work</button>
            <button class="w-1/2 rounded-lg px-4 py-2 text-sm font-semibold transition @(activeTab == "Education" ? "bg-slate-800 text-white" : "text-slate-300 hover:text-white")"
                    @onclick='() => activeTab = "Education"'>Education</button>
        </div>

        <!-- Panel -->
        <div class="rounded-2xl border border-slate-700/200 bg-slate-900/60 ">
            <ul class="ml-10 border-l border-slate-400/200">
                @foreach (var item in Items)
                {
                    <li class="relative py-4">
                        <!-- Logo centered on the line -->
                        <a target="_blank" href="@item.LogoUrl" class="absolute -left-7 top-4 flex h-12 w-12 items-center justify-center rounded-full bg-white p-0.1">
                            <span class="relative flex h-full w-full overflow-hidden rounded-full border border-slate-700/60">
                                @if (!string.IsNullOrWhiteSpace(item.LogoUrl))
                                {
                                    <img class="h-full w-full bg-slate-700 object-contain" src="@item.LogoUrl" alt="@item.Company logo" />
                                }
                            </span>
                        </a>

                        <!-- Content -->
                        <div class="ml-12">
                            <time class="text-xs text-slate-400">@item.DateRange</time>
                            <h2 class="font-semibold leading-none text-white">@item.Company</h2>
                            @if (!string.IsNullOrWhiteSpace(item.JobRole))
                            {
                                <p class="text-sm text-slate-300">@item.JobRole</p>
                            }

                            @if (item.Bullets?.Any() == true)
                            {
                                <ul class="mt-2 ml-4 list-outside list-disc space-y-1">
                                    @foreach (var b in item.Bullets)
                                    {
                                        <li class="prose pr-8 text-sm text-slate-200 dark:prose-invert">@b</li>
                                    }
                                </ul>
                            }

                            @if (item.Badges?.Any() == true)
                            {
                                <div class="mt-2 flex flex-wrap gap-2">
                                    @foreach (var badge in item.Badges)
                                    {
                                        <span class="inline-flex items-center rounded-md border border-transparent bg-slate-700/50 px-2.5 py-0.5 text-xs font-medium text-slate-200 shadow hover:bg-slate-700/70">
                                            @badge
                                        </span>
                                    }
                                </div>
                            }
                        </div>
                    </li>
                }
            </ul>
        </div>
</section>

@code {
    private string activeTab = "Work";

    private record TimelineItem(
        string DateRange,
        string Company,
        string? JobRole,
        IEnumerable<string>? Bullets,
        IEnumerable<string>? Badges = null,
        string? LogoUrl = null
    );

    private readonly List<TimelineItem> Work = new()
    {
        new TimelineItem("Aug 2022 â€“ Jul 2025", "Team International", "Software Engineer",
            new []
            {
                "Maintained legacy VB.NET systems and enhanced debugging workflows using NewRelic.",
                "Developed a ServiceNow script to auto-update incidents via scheduled jobs, which reduced AppSupport incidents by ~7%.",
                "Integrated logging through NewRelic API to improve traceability of desktop application errors, and also confirm performance degradation and locate root causes."
            },
            Array.Empty<string>(),
            "logos/TeamInternational.jpg"
        ),
        new TimelineItem("Dec 2021 â€“ Aug 2022", "SistecrÃ©dito", "Software Developer",
            new []
            {
                "Designed microservices with gRPC and Protocol Buffers.",
                "Followed Domain-Driven Design for clean architecture and separation of concerns.",
                "Structured C# projects using Microsoft conventions and SOLID principles."
            },
            Array.Empty<string>(),
            "logos/sistecredito.svg"
        ),
        new TimelineItem("May 2021 â€“ Dec 2021", "MAS Global Consulting", "Software Developer",
            new []
            {
                "Integrated BambooHR API to sync and manage employee data.",
                "Worked with Azure DevOps Boards and Git Repositories for project delivery."
            },
            Array.Empty<string>(),
            "logos/MASGlobal.png"
        ),
        new TimelineItem("Nov 2020 â€“ May 2021", "MAS Global Consulting", "Software Developer Intern",
            new []
            {
                "Analyzed and estimated user stories for payroll processing app.",
                "Practiced Scrum, Kanban, and SAFe to support agile workflows.",
                "Contributed to CI/CD pipelines and version control with Git."
            },
            Array.Empty<string>(),
            "logos/MASGlobal.png"
        )
    };

    private readonly List<TimelineItem> Education = new()
    {
        new TimelineItem("Feb 2018 â€“ Aug 2021", "Instituto TecnolÃ³gico Metropolitano",
            "Associateâ€™s degree in Information Systems",
            Array.Empty<string>(),
            Array.Empty<string>(),
            "logos/itm.svg")
    };

    private IEnumerable<TimelineItem> Items => activeTab == "Work" ? Work : Education;

    private int GetCurrentAge()
    {
        var today = DateTime.UtcNow;
        
        return today is { Month: >= 6, Day: >= 3 }
            ? today.Year - 2000
            : today.Year - 2001;
    }
}
